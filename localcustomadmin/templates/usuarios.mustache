<!-- Elegant Users Management Interface -->
<div class="elegant-users-container">
    
    <!-- Hero Header with Gradient -->
    <div class="hero-header">
        <div class="hero-content">
            <div class="hero-text">
                <h1 class="hero-title">
                    <i class="fas fa-users hero-icon"></i>
                    {{page_title}}
                </h1>
                <p class="hero-subtitle">
                    {{page_description}}
                </p>
            </div>
            
            <div class="hero-actions">
                <div class="hero-stats">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-number">{{total_users}}</span>
                            <span class="stat-label">Total de Usuários</span>
                        </div>
                    </div>
                </div>
                <a href="{{back_to_index_url}}" class="btn-manage btn-manage-secondary">
                    <i class="fas fa-arrow-left"></i>
                    Voltar
                </a>
            </div>
        </div>
    </div>
    
    <!-- Filters Section -->
    <div class="filters-section">
        <div class="filters-header">
            <h3>
                <i class="fas fa-filter mr-2"></i>
                Filtros
            </h3>
        </div>
        <form method="GET" action="" id="filtersForm">
            <div class="filters-grid">
                <div class="filter-group">
                    <label>E-mail</label>
                    <input type="text" name="email" class="filter-input" 
                           placeholder="Digite o e-mail..." value="{{filters.email}}">
                </div>
                <div class="filter-group">
                    <label>Username (Matrícula)</label>
                    <input type="text" name="username" class="filter-input" 
                           placeholder="Digite o username..." value="{{filters.username}}">
                </div>
                <div class="filter-group">
                    <label>Curso</label>
                    <select name="course" class="filter-input">
                        <option value="0">Todos os cursos</option>
                        {{#courses}}
                        <option value="{{id}}" {{#selected}}selected{{/selected}}>{{name}}</option>
                        {{/courses}}
                    </select>
                </div>
                <div class="filter-group" style="align-self: end;">
                    <button type="submit" class="btn-manage btn-manage-primary" style="width: 100%;">
                        <i class="fas fa-search"></i>
                        Filtrar
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- Users Table -->
    {{#has_users}}
    <div class="users-table-container">
        <table class="users-table">
            <thead>
                <tr>
                    <th><i class="fas fa-user mr-2"></i>Nome</th>
                    <th><i class="fas fa-envelope mr-2"></i>E-mail</th>
                    <th><i class="fas fa-id-card mr-2"></i>Username</th>
                    <th><i class="fas fa-graduation-cap mr-2"></i>Cursos</th>
                    <th><i class="fas fa-clock mr-2"></i>Último Acesso</th>
                    <th><i class="fas fa-shield-alt mr-2"></i>Status</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {{#users}}
                <tr class="user-row">
                    <td>
                        <div class="user-info">
                            <div class="user-avatar">
                                <i class="fas fa-user-circle"></i>
                            </div>
                            <div class="user-details">
                                <div class="user-name">{{fullname}}</div>
                                <div class="user-meta">{{firstname}} {{lastname}}</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <a href="mailto:{{email}}" class="user-email">
                            <i class="fas fa-envelope mr-2"></i>{{email}}
                        </a>
                    </td>
                    <td>
                        <span class="user-username">{{username}}</span>
                    </td>
                    <td>
                        <span class="badge-courses">{{enrolled_courses}}</span>
                    </td>
                    <td>
                        {{#lastlogin_timestamp}}
                        <span class="user-lastlogin">{{lastlogin}}</span>
                        {{/lastlogin_timestamp}}
                        {{^lastlogin_timestamp}}
                        <span class="text-muted">Nunca</span>
                        {{/lastlogin_timestamp}}
                    </td>
                    <td>
                        <span class="badge-status {{status_class}}">
                            <i class="fas fa-circle mr-2"></i>{{status_text}}
                        </span>
                    </td>
                    <td>
                        <div class="user-actions">
                            <a href="{{profile_url}}" class="btn-icon view" title="Ver Perfil" target="_blank">
                                <i class="fas fa-eye"></i>
                            </a>
                            <a href="{{edit_url}}" class="btn-icon edit" title="Editar" target="_blank">
                                <i class="fas fa-edit"></i>
                            </a>
                            <button type="button" class="btn-icon courses" title="Cursos" onclick="showUserCourses({{id}})">
                                <i class="fas fa-graduation-cap"></i>
                            </button>
                            <button type="button" class="btn-icon reset" title="Resetar Senha" data-userid="{{id}}">
                                <i class="fas fa-key"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                {{/users}}
            </tbody>
        </table>
        
        <!-- Pagination -->
        {{#pagination.has_pagination}}
        <div class="pagination-container">
            {{#pagination.prev_url}}
            <a href="{{pagination.prev_url}}" class="pagination-btn">
                <i class="fas fa-chevron-left"></i> Anterior
            </a>
            {{/pagination.prev_url}}
            
            <span class="pagination-info">
                Página {{pagination.current_page}} de {{pagination.total_pages}}
            </span>
            
            {{#pagination.next_url}}
            <a href="{{pagination.next_url}}" class="pagination-btn">
                Próxima <i class="fas fa-chevron-right"></i>
            </a>
            {{/pagination.next_url}}
        </div>
        {{/pagination.has_pagination}}
    </div>
    {{/has_users}}
    
    {{^has_users}}
    <div class="empty-state">
        <h3>Nenhum usuário encontrado</h3>
        <p>Tente ajustar seus filtros ou limpar a busca</p>
    </div>
    {{/has_users}}
</div>

<script>
function showUserCourses(userId) {
    alert('Visualização de cursos do usuário ID: ' + userId);
}
</script>

{{#js}}
require(['local_localcustomadmin/usuarios'], function(Usuarios) {
    Usuarios.init();
});
{{/js}}