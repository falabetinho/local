{"version":3,"file":"price_manager.min.js","sources":["0"],"sourcesContent":["/**\n * Price Manager AMD Module for Local Custom Admin\n * \n * Handles CRUD operations for category prices via AJAX\n * \n * @package   local_localcustomadmin\n * @copyright 2025 Heber\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/notification', 'core/modal', 'core/modal_factory'], function($, notification, Modal, ModalFactory) {\n    return {\n        /**\n         * Get Bootstrap instance from window (with delay for initialization)\n         */\n        getBootstrap: function() {\n            // Bootstrap 5 might not be immediately available\n            // Try to access it from window\n            if (typeof window !== 'undefined' && window.bootstrap) {\n                return window.bootstrap;\n            }\n            return null;\n        },\n\n        /**\n         * Initialize the price manager\n         * \n         * @param {number} categoryId - The category ID\n         */\n        init: function(categoryId) {\n            this.categoryId = categoryId;\n            this.setupEventHandlers();\n            this.loadPrices();\n        },\n\n        /**\n         * Setup event handlers for price management UI\n         */\n        setupEventHandlers: function() {\n            var self = this;\n\n            // Add price button\n            $(document).on('click', '#btn-add-price', function() {\n                self.showPriceForm(null);\n            });\n\n            // Save price button\n            $(document).on('click', '#btn-save-price', function() {\n                self.savePrice();\n            });\n\n            // Edit price\n            $(document).on('click', '.btn-edit-price', function(e) {\n                e.preventDefault();\n                console.log('Edit button clicked');\n                var priceId = $(this).data('price-id');\n                console.log('Price ID:', priceId);\n                self.editPrice(priceId);\n            });\n\n            // Delete price\n            $(document).on('click', '.btn-delete-price', function(e) {\n                e.preventDefault();\n                var priceId = $(this).data('price-id');\n                self.deletePrice(priceId);\n            });\n\n            // Close button (X) in modal header\n            $(document).on('click', '#priceModal .btn-close', function(e) {\n                e.preventDefault();\n                self.closeModal();\n            });\n\n            // Cancel button in modal footer\n            $(document).on('click', '#priceModal .btn-secondary[data-bs-dismiss=\"modal\"]', function(e) {\n                e.preventDefault();\n                self.closeModal();\n            });\n\n            // Close modal when clicking on backdrop\n            $(document).on('click', '#priceModal', function(e) {\n                if (e.target.id === 'priceModal') {\n                    self.closeModal();\n                }\n            });\n\n            // Close modal with ESC key\n            $(document).on('keydown', function(e) {\n                if (e.key === 'Escape' && $('#priceModal').hasClass('show')) {\n                    self.closeModal();\n                }\n            });\n        },\n\n        /**\n         * Load prices from database\n         */\n        loadPrices: function() {\n            var self = this;\n\n            $.ajax({\n                type: 'POST',\n                url: M.cfg.wwwroot + '/local/localcustomadmin/ajax/price_action.php',\n                dataType: 'json',\n                data: {\n                    action: 'getprices',\n                    categoryid: self.categoryId,\n                    activeonly: true\n                },\n                success: function(response) {\n                    console.log('Price response:', response);\n                    \n                    if (response.success && response.data && Array.isArray(response.data)) {\n                        self.renderPricesTable(response.data);\n                    } else {\n                        console.warn('Invalid price data received:', response.data);\n                        self.renderPricesTable([]);\n                    }\n                },\n                error: function(xhr, status, error) {\n                    // Silently handle error - just display empty table\n                    console.log('No prices loaded or service error:', error);\n                    self.renderPricesTable([]);\n                }\n            });\n        },\n\n        /**\n         * Render prices table\n         * \n         * @param {array} prices - Array of price objects\n         */\n        renderPricesTable: function(prices) {\n            var tbody = $('#prices-tbody');\n            tbody.html('');\n\n            // Ensure prices is an array\n            if (!Array.isArray(prices) || prices.length === 0) {\n                tbody.html('<tr class=\"empty-state-row\"><td colspan=\"9\" class=\"empty-state-cell\">' +\n                    '<div class=\"empty-state-content\">' +\n                    '<i class=\"fas fa-inbox empty-icon\"></i>' +\n                    '<p class=\"empty-message\">Nenhum preço encontrado</p>' +\n                    '<p class=\"empty-hint\">Clique em \"Adicionar Preço\" para criar um novo</p>' +\n                    '</div></td></tr>');\n                return;\n            }\n\n            prices.forEach(function(price, index) {\n                var row = '<tr class=\"price-row\" style=\"animation-delay: ' + (index * 0.05) + 's\">';\n                \n                // Price Name with icon\n                row += '<td class=\"price-name-cell\">';\n                row += '<div class=\"price-name-wrapper\">';\n                row += '<i class=\"fas fa-tag price-icon mr-2\"></i>';\n                row += '<strong class=\"price-name\">' + (price.name || '-') + '</strong>';\n                row += '</div>';\n                row += '</td>';\n                \n                // Price Value with currency\n                row += '<td class=\"price-value-cell\">';\n                row += '<span class=\"price-amount\">R$ ' + parseFloat(price.price).toFixed(2) + '</span>';\n                row += '</td>';\n                \n                // Start Date with icon\n                row += '<td class=\"date-cell\">';\n                row += '<i class=\"fas fa-calendar-check mr-2 date-icon\"></i>';\n                row += '<span class=\"date-text\">' + new Date(price.startdate * 1000).toLocaleDateString('pt-BR') + '</span>';\n                row += '</td>';\n                \n                // End Date with icon\n                row += '<td class=\"date-cell\">';\n                if (price.enddate) {\n                    row += '<i class=\"fas fa-calendar-times mr-2 date-icon\"></i>';\n                    row += '<span class=\"date-text\">' + new Date(price.enddate * 1000).toLocaleDateString('pt-BR') + '</span>';\n                } else {\n                    row += '<span class=\"text-muted\"><i class=\"fas fa-infinity mr-2\"></i>Indefinido</span>';\n                }\n                row += '</td>';\n                \n                // Promotional Badge\n                row += '<td class=\"badge-cell\">';\n                if (price.ispromotional == 1) {\n                    row += '<span class=\"elegant-badge badge-promotional\"><i class=\"fas fa-percentage mr-2\"></i>Sim</span>';\n                } else {\n                    row += '<span class=\"elegant-badge badge-default\"><i class=\"fas fa-minus mr-2\"></i>Não</span>';\n                }\n                row += '</td>';\n                \n                // Enrollment Fee Badge\n                row += '<td class=\"badge-cell\">';\n                if (price.isenrollmentfee == 1) {\n                    row += '<span class=\"elegant-badge badge-enrollment\"><i class=\"fas fa-graduation-cap mr-2\"></i>Sim</span>';\n                } else {\n                    row += '<span class=\"elegant-badge badge-default\"><i class=\"fas fa-minus mr-2\"></i>Não</span>';\n                }\n                row += '</td>';\n                \n                // Installments\n                row += '<td class=\"installments-cell\">';\n                row += '<span class=\"installments-value\">';\n                row += '<i class=\"fas fa-credit-card mr-2\"></i>';\n                row += price.installments + 'x';\n                row += '</span>';\n                row += '</td>';\n                \n                // Status Badge\n                row += '<td class=\"badge-cell\">';\n                if (price.status == 1) {\n                    row += '<span class=\"elegant-badge badge-active\"><i class=\"fas fa-check-circle mr-2\"></i>Ativo</span>';\n                } else {\n                    row += '<span class=\"elegant-badge badge-inactive\"><i class=\"fas fa-times-circle mr-2\"></i>Inativo</span>';\n                }\n                row += '</td>';\n                \n                // Actions\n                row += '<td class=\"actions-cell\">';\n                row += '<div class=\"action-buttons\">';\n                row += '<button type=\"button\" class=\"btn-action btn-action-edit btn-edit-price\" data-price-id=\"' + price.id + '\" title=\"Editar\">' +\n                    '<i class=\"fas fa-edit\"></i></button>';\n                row += '<button type=\"button\" class=\"btn-action btn-action-delete btn-delete-price\" data-price-id=\"' + price.id + '\" title=\"Excluir\">' +\n                    '<i class=\"fas fa-trash-alt\"></i></button>';\n                row += '</div>';\n                row += '</td>';\n                \n                row += '</tr>';\n                tbody.append(row);\n            });\n        },\n\n        /**\n         * Show price form (add or edit)\n         * \n         * @param {object|null} priceData - Price data if editing, null if adding\n         */\n        showPriceForm: function(priceData) {\n            var self = this;\n            console.log('showPriceForm called with data:', priceData);\n            \n            var title = priceData ? 'Edit Price' : 'Add Price';\n            \n            // Clear any previous error alerts\n            self.hideErrorAlert();\n            \n            $('#priceModalLabel').text(title);\n            console.log('Modal title set to:', title);\n            \n            if (priceData) {\n                // Edit mode: populate form with existing data\n                $('#price_id').val(priceData.id);\n                $('#price-name').val(priceData.name || '');\n                $('#price-value').val(priceData.price);\n                $('#validity-start').val(new Date(priceData.startdate * 1000).toISOString().slice(0, 16));\n                $('#validity-end').val(priceData.enddate ? new Date(priceData.enddate * 1000).toISOString().slice(0, 16) : '');\n                $('#is-promotional').prop('checked', priceData.ispromotional == 1);\n                $('#is-enrollment-fee').prop('checked', priceData.isenrollmentfee == 1);\n                $('#scheduled-task').prop('checked', priceData.scheduledtask == 1);\n                $('#installments').val(priceData.installments || 0);\n                $('#price-status').val(priceData.status);\n            } else {\n                // Add mode: reset and initialize with default dates\n                self.resetPriceForm();\n                self.initializeDateFields();\n            }\n\n            var bootstrap = self.getBootstrap();\n            console.log('Bootstrap object:', bootstrap);\n            \n            if (bootstrap) {\n                try {\n                    console.log('Creating new modal instance');\n                    var modalElement = document.getElementById('priceModal');\n                    console.log('Modal element found:', modalElement);\n                    \n                    var priceModal = new bootstrap.Modal(modalElement);\n                    console.log('Modal instance created:', priceModal);\n                    priceModal.show();\n                    console.log('Modal shown');\n                } catch (e) {\n                    console.error('Error showing modal with Bootstrap:', e);\n                    // Fallback to jQuery\n                    $('#priceModal').modal('show');\n                }\n            } else {\n                console.log('Bootstrap not available, using jQuery modal');\n                $('#priceModal').modal('show');\n            }\n        },\n\n        /**\n         * Initialize date fields with default values\n         * Start date: today at 00:00\n         * End date: today + 5 years at 00:00\n         */\n        initializeDateFields: function() {\n            var today = new Date();\n            today.setHours(0, 0, 0, 0);\n            \n            // Start date: today\n            var startDateStr = this.formatDateForInput(today);\n            $('#validity-start').val(startDateStr);\n            \n            // End date: today + 5 years\n            var endDate = new Date(today);\n            endDate.setFullYear(endDate.getFullYear() + 5);\n            var endDateStr = this.formatDateForInput(endDate);\n            $('#validity-end').val(endDateStr);\n        },\n\n        /**\n         * Format date for datetime-local input\n         * Format: YYYY-MM-DDTHH:mm\n         * \n         * @param {Date} date - The date to format\n         * @returns {string} Formatted date string\n         */\n        formatDateForInput: function(date) {\n            var year = date.getFullYear();\n            var month = String(date.getMonth() + 1).padStart(2, '0');\n            var day = String(date.getDate()).padStart(2, '0');\n            var hours = String(date.getHours()).padStart(2, '0');\n            var minutes = String(date.getMinutes()).padStart(2, '0');\n            \n            return year + '-' + month + '-' + day + 'T' + hours + ':' + minutes;\n        },\n\n        /**\n         * Edit price\n         * \n         * @param {number} priceId - Price ID to edit\n         */\n        editPrice: function(priceId) {\n            var self = this;\n            console.log('editPrice called with ID:', priceId);\n\n            $.ajax({\n                type: 'POST',\n                url: M.cfg.wwwroot + '/local/localcustomadmin/ajax/price_action.php',\n                dataType: 'json',\n                data: {\n                    action: 'getprices',\n                    categoryid: self.categoryId,\n                    activeonly: false\n                },\n                success: function(response) {\n                    console.log('Edit AJAX response:', response);\n                    if (response.success && Array.isArray(response.data) && response.data.length > 0) {\n                        // Convert priceId to number for comparison\n                        var targetId = parseInt(priceId, 10);\n                        var price = response.data.find(function(p) { \n                            return parseInt(p.id, 10) === targetId; \n                        });\n                        console.log('Found price:', price);\n                        if (price) {\n                            self.showPriceForm(price);\n                        } else {\n                            console.warn('Price not found with ID:', priceId, 'in data:', response.data);\n                        }\n                    } else {\n                        console.warn('Invalid response data:', response.data);\n                    }\n                },\n                error: function(xhr, status, error) {\n                    console.error('Edit AJAX error:', error);\n                    self.showErrorAlert('Failed to load price details');\n                }\n            });\n        },\n\n        /**\n         * Save price (create or update)\n         */\n        savePrice: function() {\n            var self = this;\n            var priceId = $('#price_id').val();\n            var priceName = $('#price-name').val();\n            var price = $('#price-value').val();\n            var validityStart = new Date($('#validity-start').val()).getTime() / 1000;\n            var validityEnd = $('#validity-end').val() ? new Date($('#validity-end').val()).getTime() / 1000 : null;\n            var isPromotional = $('#is-promotional').is(':checked') ? 1 : 0;\n            var isEnrollmentFee = $('#is-enrollment-fee').is(':checked') ? 1 : 0;\n            var scheduledTask = $('#scheduled-task').is(':checked') ? 1 : 0;\n            var installments = parseInt($('#installments').val()) || 0;\n            var status = $('#price-status').val();\n\n            // Validation\n            if (!priceName || priceName.trim() === '') {\n                notification.alert('Please enter a price name', 'Validation Error');\n                return;\n            }\n\n            if (!price || price <= 0) {\n                notification.alert('Please enter a valid price', 'Validation Error');\n                return;\n            }\n\n            if (!validityStart || isNaN(validityStart)) {\n                notification.alert('Please enter a valid start date', 'Validation Error');\n                return;\n            }\n\n            if (installments < 0) {\n                notification.alert('Installments cannot be negative', 'Validation Error');\n                return;\n            }\n\n            var wsFunction = priceId ? 'updateprice' : 'createprice';\n            var postData = {\n                action: wsFunction,\n                categoryid: self.categoryId,\n                name: priceName,\n                price: price,\n                startdate: validityStart,\n                enddate: validityEnd || null,\n                ispromotional: isPromotional,\n                isenrollmentfee: isEnrollmentFee,\n                scheduledtask: scheduledTask,\n                installments: installments,\n                status: status\n            };\n\n            if (priceId) {\n                postData.id = priceId;\n            }\n\n            $.ajax({\n                type: 'POST',\n                url: M.cfg.wwwroot + '/local/localcustomadmin/ajax/price_action.php',\n                dataType: 'json',\n                data: postData,\n                success: function(response) {\n                    if (response.success) {\n                        var bootstrap = self.getBootstrap();\n                        if (bootstrap) {\n                            try {\n                                var priceModal = bootstrap.Modal.getInstance(document.getElementById('priceModal'));\n                                if (priceModal) {\n                                    priceModal.hide();\n                                }\n                            } catch (e) {\n                                console.log('Bootstrap hide failed, using jQuery');\n                                $('#priceModal').modal('hide');\n                            }\n                        } else {\n                            // Fallback to jQuery\n                            $('#priceModal').modal('hide');\n                        }\n                        self.loadPrices();\n                        notification.alert(priceId ? 'Price updated successfully' : 'Price created successfully', 'Success');\n                    } else {\n                        self.showErrorAlert(response.error || 'Error saving price');\n                    }\n                },\n                error: function(xhr, status, error) {\n                    console.error('Error saving price:', error);\n                    var errorMsg = 'Failed to save price';\n                    try {\n                        if (xhr.responseJSON && xhr.responseJSON.error) {\n                            errorMsg = xhr.responseJSON.error;\n                        }\n                    } catch (e) {\n                        // Ignore parsing errors\n                    }\n                    self.showErrorAlert(errorMsg);\n                }\n            });\n        },\n\n        /**\n         * Show error alert inside the modal\n         */\n        showErrorAlert: function(message) {\n            var alertEl = $('#price-alert');\n            var messageEl = $('#price-alert-message');\n            \n            messageEl.text(message);\n            alertEl.removeClass('alert-success alert-info').addClass('alert-danger');\n            alertEl.show();\n            \n            // Auto-hide after 5 seconds\n            setTimeout(function() {\n                alertEl.fadeOut();\n            }, 5000);\n        },\n\n        /**\n         * Hide alert inside the modal\n         */\n        hideErrorAlert: function() {\n            $('#price-alert').hide().removeClass('alert-danger alert-success alert-info');\n        },\n\n        /**\n         * Delete price\n         * \n         * @param {number} priceId - Price ID to delete\n         */\n        deletePrice: function(priceId) {\n            var self = this;\n\n            if (!confirm('Are you sure you want to delete this price?')) {\n                return;\n            }\n\n            $.ajax({\n                type: 'POST',\n                url: M.cfg.wwwroot + '/local/localcustomadmin/ajax/price_action.php',\n                dataType: 'json',\n                data: {\n                    action: 'deleteprice',\n                    categoryid: self.categoryId,\n                    id: priceId\n                },\n                success: function(response) {\n                    if (response.success) {\n                        self.loadPrices();\n                        notification.alert('Price deleted successfully', 'Success');\n                    } else {\n                        notification.alert(response.error || 'Error deleting price', 'Error');\n                    }\n                },\n                error: function() {\n                    notification.exception(new Error('Failed to delete price'));\n                }\n            });\n        },\n\n        /**\n         * Close modal\n         */\n        closeModal: function() {\n            var self = this;\n            var bootstrap = self.getBootstrap();\n            \n            if (bootstrap) {\n                try {\n                    var modalElement = document.getElementById('priceModal');\n                    var priceModal = bootstrap.Modal.getInstance(modalElement);\n                    if (priceModal) {\n                        priceModal.hide();\n                    } else {\n                        // If no instance exists, try to create one and hide it\n                        priceModal = new bootstrap.Modal(modalElement);\n                        priceModal.hide();\n                    }\n                } catch (e) {\n                    console.log('Bootstrap hide failed, using jQuery', e);\n                    $('#priceModal').modal('hide');\n                }\n            } else {\n                // Fallback to jQuery\n                $('#priceModal').modal('hide');\n            }\n            \n            // Reset form and hide alerts\n            self.resetPriceForm();\n            self.hideErrorAlert();\n        },\n\n        /**\n         * Reset price form\n         */\n        resetPriceForm: function() {\n            $('#price-form')[0].reset();\n            $('#price_id').val('');\n        }\n    };\n});\n"],"names":["define","$","notification","Modal","ModalFactory","getBootstrap","window","bootstrap","init","categoryId","this","setupEventHandlers","loadPrices","self","document","on","showPriceForm","savePrice","e","preventDefault","console","log","priceId","data","editPrice","deletePrice","closeModal","target","id","key","hasClass","ajax","type","url","M","cfg","wwwroot","dataType","action","categoryid","activeonly","success","response","Array","isArray","renderPricesTable","warn","error","xhr","status","prices","tbody","html","length","forEach","price","index","row","name","parseFloat","toFixed","Date","startdate","toLocaleDateString","enddate","append","ispromotional","isenrollmentfee","installments","priceData","title","hideErrorAlert","text","val","toISOString","slice","prop","scheduledtask","resetPriceForm","initializeDateFields","modalElement","getElementById","priceModal","show","modal","today","startDateStr","setHours","formatDateForInput","endDate","endDateStr","setFullYear","getFullYear","date","String","getMonth","padStart","getDate","getHours","getMinutes","targetId","parseInt","find","p","showErrorAlert","priceName","validityStart","getTime","validityEnd","isPromotional","is","isEnrollmentFee","scheduledTask","trim","alert","isNaN","postData","getInstance","hide","errorMsg","responseJSON","message","alertEl","removeClass","addClass","setTimeout","fadeOut","confirm","exception","Error","reset"],"mappings":"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"}