define(["jquery","core/ajax","core/notification","core/str"],function(r,s,a,o){return{init:function(){console.log("WordPress Sync module initialized"),this.attachEventListeners()},attachEventListeners:function(){var a=this;console.log("Attaching event listeners for WordPress sync"),r(document).on("click","[data-action]",function(s){s.preventDefault();var s=r(this).data("action"),o=r(this);switch(console.log("Action clicked:",s),s){case"sync-categories":a.syncCategories(o);break;case"sync-all-courses":a.syncAllCourses(o);break;case"sync-prices":a.syncPrices(o);break;case"sync-single-course":var e=r(this).data("courseid");a.syncSingleCourse(e,o);break;case"toggle-course-visibility":var e=r(this).data("courseid"),c=r(this).data("visible");a.toggleCourseVisibility(e,c,o);break;case"delete-course-wp":e=r(this).data("courseid");a.deleteCourseFromWordPress(e,o);break;case"test-connection":a.testConnection(o);break;case"sync-single-category":c=r(this).data("categoryid");a.syncSingleCategory(c,o)}})},syncCategories:function(s){var c=this,o=(console.log("syncCategories method called"),s.prop("disabled",!0),s.html());s.html('<i class="fa fa-spinner fa-spin"></i> Sincronizando...'),console.log("Making AJAX request to sync categories"),r.ajax({url:M.cfg.wwwroot+"/local/localcustomadmin/ajax/sync_categories.php?action=sync_all&sesskey="+M.cfg.sesskey,method:"POST",dataType:"json",success:function(s){var o,e;console.log("AJAX success:",s),s.success?(e="Sincronização concluída!\n",e+="Criadas: "+(o=s.data).success+"\n",a.addNotification({message:e=(e+="Atualizadas: "+o.updated+"\n")+("Erros: "+o.errors+"\n")+("Ignoradas: "+o.skipped),type:"success"}),c.updateStatistics()):a.addNotification({message:"Erro na sincronização: "+s.error,type:"error"})},error:function(s,o,e){console.error("AJAX error:",o,e),console.error("Response:",s.responseText),a.addNotification({message:"Erro ao conectar com o servidor: "+e,type:"error"})},complete:function(){s.prop("disabled",!1),s.html(o)}})},syncSingleCategory:function(s,o){o.prop("disabled",!0);var e=o.html();o.html('<i class="fa fa-spinner fa-spin"></i>'),r.ajax({url:M.cfg.wwwroot+"/local/localcustomadmin/ajax/sync_categories.php",method:"POST",data:{action:"sync_single",categoryid:s,sesskey:M.cfg.sesskey},dataType:"json",success:function(s){s.success?(a.addNotification({message:"Categoria sincronizada com sucesso!",type:"success"}),self.updateStatistics()):a.addNotification({message:"Erro: "+s.error,type:"error"})},error:function(s,o,e){a.addNotification({message:"Erro ao conectar: "+e,type:"error"})},complete:function(){o.prop("disabled",!1),o.html(e)}})},testConnection:function(s){console.log("testConnection method called"),s.prop("disabled",!0);var o=s.html();s.html('<i class="fa fa-spinner fa-spin"></i> Testando...'),console.log("Making AJAX request to test connection"),r.ajax({url:M.cfg.wwwroot+"/local/localcustomadmin/ajax/test_connection.php",method:"POST",data:{sesskey:M.cfg.sesskey},dataType:"json",success:function(s){console.log("Test connection response:",s),s.success&&s.connected?a.addNotification({message:"✓ Conexão com WordPress OK!\nEndpoint: "+s.endpoint,type:"success"}):a.addNotification({message:"✗ Falha na conexão\n"+(s.error||s.message),type:"error"})},error:function(s,o,e){console.error("Test connection error:",o,e),console.error("Response:",s.responseText),a.addNotification({message:"Erro ao testar conexão: "+e,type:"error"})},complete:function(){s.prop("disabled",!1),s.html(o)}})},updateStatistics:function(){console.log("Updating statistics..."),r.ajax({url:M.cfg.wwwroot+"/local/localcustomadmin/ajax/sync_categories.php?action=get_stats&sesskey="+M.cfg.sesskey,method:"GET",dataType:"json",success:function(s){s.success&&s.data&&(s=s.data,r('[data-stat="total"]').text(s.total||0),r('[data-stat="synced"]').text(s.synced||0),r('[data-stat="pending"]').text(s.pending||0),console.log("Statistics updated:",s))},error:function(s,o,e){console.error("Error updating statistics:",e)}})},syncAllCourses:function(s){console.log("syncAllCourses method called"),s.prop("disabled",!0);var o=s.html();s.html('<i class="fa fa-spinner fa-spin"></i> Sincronizando...'),console.log("Making AJAX request to sync all courses"),r.ajax({url:M.cfg.wwwroot+"/local/localcustomadmin/ajax/sync_courses.php?action=sync_all&sesskey="+M.cfg.sesskey,method:"POST",dataType:"json",success:function(s){var o;console.log("AJAX success:",s),void 0!==s.success?(o="Sincronização de cursos concluída!\n",o+="Total: "+s.total+"\n",a.addNotification({message:o=o+("Sucesso: "+s.success+"\n")+("Falhas: "+s.failed),type:0<s.failed?"warning":"success"}),setTimeout(function(){window.location.reload()},2e3)):a.addNotification({message:"Erro ao sincronizar cursos: "+(s.message||"Erro desconhecido"),type:"error"})},error:function(s,o,e){console.error("AJAX error:",e),a.addNotification({message:"Erro na sincronização: "+e,type:"error"})},complete:function(){s.prop("disabled",!1),s.html(o)}})},syncPrices:function(s){console.log("syncPrices method called"),s.prop("disabled",!0);var o=s.html();s.html('<i class="fa fa-spinner fa-spin"></i> Sincronizando preços...'),console.log("Making AJAX request to sync prices"),r.ajax({url:M.cfg.wwwroot+"/local/localcustomadmin/ajax/sync_courses.php?action=bulk_sync_prices&sesskey="+M.cfg.sesskey,method:"POST",dataType:"json",success:function(s){console.log("AJAX success:",s),s.success?a.addNotification({message:"Preços sincronizados com sucesso!",type:"success"}):a.addNotification({message:"Erro ao sincronizar preços: "+(s.message||"Erro desconhecido"),type:"error"})},error:function(s,o,e){console.error("AJAX error:",e),a.addNotification({message:"Erro na sincronização de preços: "+e,type:"error"})},complete:function(){s.prop("disabled",!1),s.html(o)}})},syncSingleCourse:function(s,o){console.log("syncSingleCourse called for course ID:",s),o.prop("disabled",!0);var e=o.html(),s=(o.html('<i class="fa fa-spinner fa-spin"></i>'),M.cfg.wwwroot+"/local/localcustomadmin/ajax/sync_courses.php?action=sync_course&courseid="+s+"&sesskey="+M.cfg.sesskey);console.log("AJAX URL:",s),r.ajax({url:s,method:"POST",dataType:"json",success:function(s){console.log("AJAX success:",s),s.success?(a.addNotification({message:"Curso sincronizado com sucesso!",type:"success"}),setTimeout(function(){window.location.reload()},1e3)):a.addNotification({message:"Erro ao sincronizar curso: "+(s.message||"Erro desconhecido"),type:"error"})},error:function(s,o,e){console.error("AJAX error:",e),a.addNotification({message:"Erro na sincronização: "+e,type:"error"})},complete:function(){o.prop("disabled",!1),o.html(e)}})},toggleCourseVisibility:function(s,o,e){var c,o=o?0:1;confirm("Deseja "+(o?"mostrar":"ocultar")+" este curso no WordPress?")&&(console.log("toggleCourseVisibility called for course ID:",s,"newVisible:",o),e.prop("disabled",!0),c=e.html(),e.html('<i class="fa fa-spinner fa-spin"></i>'),s=M.cfg.wwwroot+"/local/localcustomadmin/ajax/sync_courses.php?action=toggle_visibility&courseid="+s+"&visible="+o+"&sesskey="+M.cfg.sesskey,r.ajax({url:s,method:"POST",dataType:"json",success:function(s){console.log("AJAX success:",s),s.success?(a.addNotification({message:s.message,type:"success"}),setTimeout(function(){window.location.reload()},1e3)):a.addNotification({message:"Erro: "+(s.message||"Erro desconhecido"),type:"error"})},error:function(s,o,e){console.error("AJAX error:",e),a.addNotification({message:"Erro na requisição: "+e,type:"error"})},complete:function(){e.prop("disabled",!1),e.html(c)}}))},deleteCourseFromWordPress:function(s,o){var e;confirm("Tem certeza que deseja DELETAR este curso do WordPress?\n\nEsta ação não pode ser desfeita!")&&(console.log("deleteCourseFromWordPress called for course ID:",s),o.prop("disabled",!0),e=o.html(),o.html('<i class="fa fa-spinner fa-spin"></i>'),s=M.cfg.wwwroot+"/local/localcustomadmin/ajax/sync_courses.php?action=delete_course&courseid="+s+"&sesskey="+M.cfg.sesskey,r.ajax({url:s,method:"POST",dataType:"json",success:function(s){console.log("AJAX success:",s),s.success?(a.addNotification({message:s.message,type:"success"}),setTimeout(function(){window.location.reload()},1e3)):a.addNotification({message:"Erro: "+(s.message||"Erro desconhecido"),type:"error"})},error:function(s,o,e){console.error("AJAX error:",e),a.addNotification({message:"Erro na requisição: "+e,type:"error"})},complete:function(){o.prop("disabled",!1),o.html(e)}}))}}});
//# sourceMappingURL=wordpress_sync.min.js.map