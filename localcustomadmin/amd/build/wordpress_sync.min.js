define(["jquery","core/ajax","core/notification","core/str"],function(a,e,n,o){return{init:function(){console.log("WordPress Sync module initialized"),this.attachEventListeners()},attachEventListeners:function(){var t=this;console.log("Attaching event listeners for WordPress sync"),a(document).on("click","[data-action]",function(e){e.preventDefault();var e=a(this).data("action"),o=a(this);switch(console.log("Action clicked:",e),e){case"sync-categories":t.syncCategories(o);break;case"test-connection":t.testConnection(o);break;case"sync-single-category":var s=a(this).data("categoryid");t.syncSingleCategory(s,o)}})},syncCategories:function(e){var t=this,o=(console.log("syncCategories method called"),e.prop("disabled",!0),e.html());e.html('<i class="fa fa-spinner fa-spin"></i> Sincronizando...'),console.log("Making AJAX request to sync categories"),a.ajax({url:M.cfg.wwwroot+"/local/localcustomadmin/ajax/sync_categories.php?action=sync_all&sesskey="+M.cfg.sesskey,method:"POST",dataType:"json",success:function(e){var o,s;console.log("AJAX success:",e),e.success?(s="Sincronização concluída!\n",s+="Criadas: "+(o=e.data).success+"\n",n.addNotification({message:s=(s+="Atualizadas: "+o.updated+"\n")+("Erros: "+o.errors+"\n")+("Ignoradas: "+o.skipped),type:"success"}),t.updateStatistics()):n.addNotification({message:"Erro na sincronização: "+e.error,type:"error"})},error:function(e,o,s){console.error("AJAX error:",o,s),console.error("Response:",e.responseText),n.addNotification({message:"Erro ao conectar com o servidor: "+s,type:"error"})},complete:function(){e.prop("disabled",!1),e.html(o)}})},syncSingleCategory:function(e,o){o.prop("disabled",!0);var s=o.html();o.html('<i class="fa fa-spinner fa-spin"></i>'),a.ajax({url:M.cfg.wwwroot+"/local/localcustomadmin/ajax/sync_categories.php",method:"POST",data:{action:"sync_single",categoryid:e,sesskey:M.cfg.sesskey},dataType:"json",success:function(e){e.success?(n.addNotification({message:"Categoria sincronizada com sucesso!",type:"success"}),self.updateStatistics()):n.addNotification({message:"Erro: "+e.error,type:"error"})},error:function(e,o,s){n.addNotification({message:"Erro ao conectar: "+s,type:"error"})},complete:function(){o.prop("disabled",!1),o.html(s)}})},testConnection:function(e){console.log("testConnection method called"),e.prop("disabled",!0);var o=e.html();e.html('<i class="fa fa-spinner fa-spin"></i> Testando...'),console.log("Making AJAX request to test connection"),a.ajax({url:M.cfg.wwwroot+"/local/localcustomadmin/ajax/test_connection.php",method:"POST",data:{sesskey:M.cfg.sesskey},dataType:"json",success:function(e){console.log("Test connection response:",e),e.success&&e.connected?n.addNotification({message:"✓ Conexão com WordPress OK!\nEndpoint: "+e.endpoint,type:"success"}):n.addNotification({message:"✗ Falha na conexão\n"+(e.error||e.message),type:"error"})},error:function(e,o,s){console.error("Test connection error:",o,s),console.error("Response:",e.responseText),n.addNotification({message:"Erro ao testar conexão: "+s,type:"error"})},complete:function(){e.prop("disabled",!1),e.html(o)}})},updateStatistics:function(){console.log("Updating statistics..."),a.ajax({url:M.cfg.wwwroot+"/local/localcustomadmin/ajax/sync_categories.php?action=get_stats&sesskey="+M.cfg.sesskey,method:"GET",dataType:"json",success:function(e){e.success&&e.data&&(e=e.data,a('[data-stat="total"]').text(e.total||0),a('[data-stat="synced"]').text(e.synced||0),a('[data-stat="pending"]').text(e.pending||0),console.log("Statistics updated:",e))},error:function(e,o,s){console.error("Error updating statistics:",s)}})}}});
//# sourceMappingURL=wordpress_sync.min.js.map